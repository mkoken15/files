<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Gestionnaire de Fichiers Local (IndexedDB)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Styles restants inchang√©s pour la clart√© */
  </style>
</head>
<body>
  <h1>üìÅ Gestionnaire de Fichiers Local</h1>
  <div class="section">
    <h2>Cr√©er un dossier</h2>
    <input type="text" id="folderName" placeholder="Nom du dossier" />
    <button onclick="createFolder()">Cr√©er</button>
  </div>
  <div class="section">
    <h2>Ajouter des fichiers</h2>
    <select id="folderSelect">
      <option disabled selected>-- Choisir un dossier --</option>
    </select>
    <input type="file" id="fileInput" multiple />
    <button onclick="addFiles()">Ajouter</button>
  </div>
  <div class="section">
    <h2>Dossiers et Fichiers</h2>
    <div id="foldersContainer"></div>
  </div>
  <div id="fullscreenViewer" onclick="hideFullscreen()"></div>
  <script>
    // Initialisation et fonctions IndexedDB inchang√©es

    function loadFolders() {
      const tx = db.transaction(STORE_NAME, "readonly");
      const store = tx.objectStore(STORE_NAME);
      const request = store.getAll();
      request.onsuccess = () => {
        const data = request.result;
        const foldersMap = {};
        data.forEach(file => {
          if (!foldersMap[file.folder]) foldersMap[file.folder] = [];
          foldersMap[file.folder].push(file);
        });
        renderFolders(foldersMap);
        updateFolderSelect(Object.keys(foldersMap));
      };
    }

    function renderFolders(foldersMap) {
      const container = document.getElementById("foldersContainer");
      container.innerHTML = "";
      for (let folder in foldersMap) {
        const div = document.createElement("div");
        div.className = "folder";
        div.innerHTML = `<h3>${folder}</h3><div class="preview" id="preview-${folder}"></div>`;
        const preview = div.querySelector('.preview');
        foldersMap[folder].forEach(file => {
          let element;
          if (file.type.startsWith('image')) {
            element = document.createElement('img');
            element.src = file.data;
          } else if (file.type.startsWith('video')) {
            element = document.createElement('video');
            element.src = file.data;
            element.controls = true;
          }
          if (element) {
            element.onclick = () => showFullscreen(file);
            const wrapper = document.createElement('div');
            wrapper.style.display = 'inline-block';
            wrapper.appendChild(element);
            const delBtn = document.createElement('button');
            delBtn.textContent = 'Supprimer';
            delBtn.className = 'file-actions-btn';
            delBtn.onclick = (e) => {
              e.stopPropagation();
              deleteFile(file.id);
            };
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'file-actions';
            actionsDiv.appendChild(delBtn);
            wrapper.appendChild(actionsDiv);
            preview.appendChild(wrapper);
          }
        });
        container.appendChild(div);
      }
    }

    // Autres fonctions restantes inchang√©es
  </script>
</body>
</html>